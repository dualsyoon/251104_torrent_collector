# 주요 변경사항 (v3.0.0)

## 🎉 완료된 작업

### 1. **모든 스크래퍼 Selenium으로 변경** ✅
- ❌ 일반 requests 스크래퍼 제거 (ISP 차단됨)
- ✅ `SeleniumSukebeiScraper`: Sukebei.nyaa.si 전용
- ✅ `SeleniumJAVTorrentScraper`: JAVTorrent.re 전용
- ✅ 모두 실제 브라우저로 작동 → ISP 차단 완전 우회

### 2. **AV만 수집 (동인지/망가/게임 제외)** ✅
```python
# 제외 키워드
excluded = ['doujin', 'manga', 'game', 'comic', 'picture', 'audio', 'real life']

# 카테고리 필터링
if any(keyword in category.lower() for keyword in excluded):
    continue  # 스킵
```

### 3. **마그넷 링크 수집 개선** ✅
```python
# 3단계 마그넷 링크 추출
1. 직접 magnet: 링크
2. 다운로드 버튼/아이콘에서
3. 모든 <a> 태그에서 magnet: 검색
```

### 4. **날짜 자동 추정** ✅
```python
# MetadataEnricher 추가
1. 제목에서 날짜 패턴 추출 (YYYY-MM-DD, YYYYMMDD)
2. 작품 코드로 출시일 검색
3. 시더 수 기반 추정 (시더 많음 = 최근)
```

### 5. **페이지네이션 (100개씩)** ✅
- 메모리 절약: 한 번에 100개만 로드
- 페이지 이동: ◀ 이전 / 다음 ▶
- 직접 이동: 페이지 번호 입력
- 전체 표시: "페이지 1/5 - 100개 표시 (전체 500개)"

### 6. **데이터베이스 경로 변경** ✅
```python
# 이전: torrents.db
# 현재: ./torrents.db (명시적 현재 디렉토리)
```

### 7. **정렬 기능 추가** ✅
- 컬럼 헤더 클릭 → 정렬
- 숫자 필드: 크기순 정렬
- 재클릭: 역순 정렬

### 8. **새로운 필드** ✅
| 필드 | 설명 | 정렬 |
|------|------|------|
| 완료수 | 다운로드 완료 횟수 | ✅ |
| 조회수 | 추정 조회수 | ✅ |
| 댓글 | 댓글 개수 | ✅ |
| 인기도 | 종합 점수 (0-100) | ✅ |

## 📊 성능 개선

### 이전 (v2.x)
- 스크래퍼: requests (ISP 차단됨 ❌)
- 메모리: 전체 로드 (수천 개 → 느림)
- 페이지: 없음
- 필터링: 기본만

### 현재 (v3.0)
- 스크래퍼: Selenium (ISP 우회 ✅)
- 메모리: 100개씩 (빠름 ⚡)
- 페이지: 완벽 지원
- 필터링: 고급 (AV만, 검열, 국가 등)

## 🚀 사용법

### 1. 데이터 수집
```bash
python main.py
# GUI에서 "⭐ Sukebei (Selenium)" 선택
# [토렌트 수집] 클릭
# → 3페이지 (75개) 자동 수집, AV만!
```

### 2. 페이지 이동
```
[◀ 이전] [페이지 입력: 2] [다음 ▶]
↓
페이지: 2 / 5 - 100개 표시 (전체 500개)
```

### 3. 정렬
```
[제목] [크기] [시더↓] [리처] [완료수] [조회수] [댓글] [인기도↓] [날짜] [국가]
                  ↑ 클릭하면 정렬
```

## 🔧 기술 스택

### 스크래핑
- **Selenium WebDriver**: 브라우저 자동화
- **ChromeDriver**: Chrome 제어
- **BeautifulSoup**: HTML 파싱

### 데이터베이스
- **SQLite**: 로컬 DB (./torrents.db)
- **SQLAlchemy**: ORM
- **페이지네이션**: LIMIT/OFFSET

### GUI
- **PySide6**: Qt6 기반 GUI
- **QTableWidget**: 테이블 표시
- **정렬 지원**: 컬럼 클릭

## 📈 인기도 계산 공식

```python
인기도 (0-100) = 
    시더 점수 (30%) +
    완료수 점수 (25%) +
    조회수 점수 (20%) +
    리처 점수 (15%) +
    댓글 점수 (10%)
```

## 🎯 다음 업데이트 예정

### v3.1 (계획 중)
- [ ] 썸네일 표시 (GUI 컬럼)
- [ ] 전체 페이지 스크래핑 옵션
- [ ] 자동 업데이트 (백그라운드)
- [ ] 북마크/즐겨찾기 기능

### v3.2 (계획 중)
- [ ] 토렌트 클라이언트 연동
- [ ] 통계 대시보드
- [ ] 내보내기/가져오기 (JSON, CSV)

## 🐛 버그 수정

- ✅ ISP 차단 문제 (Selenium으로 해결)
- ✅ 마그넷 링크 누락 (3단계 추출)
- ✅ 날짜 없음 (자동 추정)
- ✅ 메모리 과다 사용 (페이지네이션)
- ✅ UnicodeEncodeError (이모지 제거)

## 📝 주의사항

### VPN 권장 (한국)
- 한국에서는 VPN 사용 권장
- 또는 Selenium 스크래퍼 사용 (이미 적용됨)

### 샘플 데이터
```bash
# VPN 없이 테스트
python add_sample_data.py
python main.py
```

### 데이터베이스
```bash
# 현재 디렉토리에 생성됨
ls -la ./torrents.db

# 백업
cp ./torrents.db ./torrents_backup.db
```

## 🎉 결론

**v3.0은 완전히 새롭게 작성되었습니다!**
- ✅ 모든 ISP 차단 우회
- ✅ AV만 수집 (깔끔)
- ✅ 메모리 효율적
- ✅ 정렬/필터링 완벽
- ✅ 사용하기 쉬움

**지금 바로 사용하세요!** 🚀

